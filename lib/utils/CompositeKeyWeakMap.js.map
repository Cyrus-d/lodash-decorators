{"version":3,"file":"CompositeKeyWeakMap.js","sourceRoot":"","sources":["../../src/utils/CompositeKeyWeakMap.ts"],"names":[],"mappings":";;AAAA,uCAAwC;AACxC;;;;;;GAMG;AACH;IAAA;QACU,aAAQ,GAAG,IAAI,OAAO,EAAY,CAAC;IAqC7C,CAAC;IAnCC,iCAAG,GAAH,UAAI,IAAW,EAAE,KAAQ;QACvB,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC;QAExB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YACnD,IAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;YACpB,IAAI,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAExB,IAAI,CAAC,IAAI,EAAE;gBACT,IAAI,GAAG,IAAI,GAAG,EAAE,CAAC;gBACjB,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;aACpB;YAED,GAAG,GAAG,IAAI,CAAC;SACZ;QAED,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;IACxC,CAAC;IAED,iCAAG,GAAH,UAAI,IAAW;QACb,IAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC;QAEzB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YAC/C,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;YAEzB,IAAI,uBAAW,CAAC,IAAI,CAAC,EAAE;gBACrB,MAAM;aACP;SACF;QAED,OAAO,IAAW,CAAC;IACrB,CAAC;IAED,iCAAG,GAAH,UAAI,IAAW;QACb,OAAO,CAAC,uBAAW,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;IACtC,CAAC;IACH,0BAAC;AAAD,CAAC,AAtCD,IAsCC;AAtCY,kDAAmB","sourcesContent":["import { isUndefined } from 'lodash-es';\r\n/**\r\n * A map for weakly holding nested references.\r\n * @private\r\n * @export\r\n * @class CompositeKeyWeakMap\r\n * @template T\r\n */\r\nexport class CompositeKeyWeakMap<T> {\r\n  private _weakMap = new WeakMap<any, any>();\r\n\r\n  set(keys: any[], value: T): void {\r\n    let map = this._weakMap;\r\n\r\n    for (let i = 0, len = keys.length - 1; i < len; i++) {\r\n      const key = keys[i];\r\n      let next = map.get(key);\r\n\r\n      if (!next) {\r\n        next = new Map();\r\n        map.set(key, next);\r\n      }\r\n\r\n      map = next;\r\n    }\r\n\r\n    map.set(keys[keys.length - 1], value);\r\n  }\r\n\r\n  get(keys: any[]): T {\r\n    let next = this._weakMap;\r\n\r\n    for (let i = 0, len = keys.length; i < len; i++) {\r\n      next = next.get(keys[i]);\r\n\r\n      if (isUndefined(next)) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    return next as any;\r\n  }\r\n\r\n  has(keys: any[]): boolean {\r\n    return !isUndefined(this.get(keys));\r\n  }\r\n}\r\n"]}